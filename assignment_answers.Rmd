---
title: "Assignment 11"
author: "Scott Stoltzman"
date: "6/26/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library('tidyverse')
library('caret')
library('rpart') # install.packages(c('rpart', 'rattle'))
library('rattle')
library('titanic')
```


# The Titanic Data

```{r}
# Load the data
data("titanic_train") # training
dat = titanic_train %>% 
  as_tibble() %>%
  mutate(Survived = factor(Survived)) # this is binary yes/no 0/1
```


## Determine what's worth analyzing

We are going to try and predict `Survived`

```{r}
head(dat)
```



```{r}
dat %>% summary()
```


```{r}
dat %>% glimpse()
```

## What is the difference between the following functions (conceptually)?

`colSums(dat == '')`
`colSums(is.na(dat))`

< Answer Here >
```{r}

```


## How should we handle missing values?
Looking at `Embarked`
```{r}
dat %>% group_by(Embarked) %>% count()
```

## For learning purposes impute the following values:
  - Missing `Embarked` values should be `S`
  - Missing and `NA` values for `Age` should be replaced by the median `Age` 
  - `NA` values for `Fare` should be replaced by the mean `Fare` 
  - Why should we drop `PassengerId, Ticket, Name, Cabin` from our data?
< Answer with code below >
```{r}
dat_clean = dat %>%
  mutate() %>%
  select() # Add your code
dat_clean %>% summary()
```

## Prepare data to train a model

Separate the data into test and train, call the new data (which has the imputed values) `dat_train` and `dat_test` to distinguish them from the raw data. Use an 80%/20% train/test split.

< Answer in code Below >

```{r}
dat_train = ...
dat_test = ...
```



## Build and train a model
Use the `caret` package and `rpart` to build a decision tree to predict survived. Do you need to rename to `Class`?
< Answer with code below >
```{r}
train_control = trControl()

mod = train() # Add your code within glm()

```

### Is there anything interesting in your model?
< Answer Here >

Plot your model using the `fancyRpartPlot()` function. Describe what the splits mean.

```{r}

```

Use the `predict` function and then create a confusion matrix `confusionMatrix()` and describe the output.
```{r}
predictions = ...
actuals = ...
confusionMatrix() # Add your code here
```


## Major issues

Did you resample your data? 

< Answer Here >
